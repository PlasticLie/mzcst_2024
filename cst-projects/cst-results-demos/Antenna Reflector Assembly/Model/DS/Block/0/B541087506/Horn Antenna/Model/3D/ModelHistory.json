{
    "general": {
        "version": "2024.0",
        "date": "2023-07-09",
        "acis": "33.0.1",
        "buildnumber": "20230709",
        "project_type": "MWS",
        "length": "mm",
        "frequency": {
            "unit": "GHz",
            "minimum": "4",
            "maximum": "5",
            "minimum_expr": "4",
            "maximum_expr": "5"
        },
        "time": "ns",
        "created": "2017.0|26.0.1|20161127"
    },
    "history": [
        {
            "caption": "new component: component1",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Component ",
                ".New \"component1\"",
                "End With"
            ]
        },
        {
            "caption": "define brick: component1:solid1",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Brick ",
                ".Reset",
                ".Name \"solid1\"",
                ".Component \"component1\"",
                ".Material \"PEC\"",
                ".Xrange \"-waveguide_width/2\", \"waveguide_width/2\"",
                ".Yrange \"-waveguide_height/2\", \"waveguide_height/2\"",
                ".Zrange \"0\", \"6\"",
                ".Create",
                "End With"
            ]
        },
        {
            "caption": "pick face",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Pick",
                ".PickFaceFromId \"component1:solid1\", \"1\"",
                "End With"
            ]
        },
        {
            "caption": "define extrude: component1:solid2",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Extrude",
                ".Name \"solid2\"",
                ".Component \"component1\"",
                ".Material \"PEC\"",
                ".Mode \"Picks\"",
                ".Height \"horn_length\"",
                ".Twist \"0.0\"",
                ".Taper \"taper_angle\"",
                ".UsePicksForHeight \"False\"",
                ".DeleteBaseFaceSolid \"False\"",
                ".ClearPickedFace \"True\"",
                ".Create",
                "End With"
            ]
        },
        {
            "caption": "boolean add shapes: component1:solid1, component1:solid2",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Solid",
                ".Add \"component1:solid1\", \"component1:solid2\"",
                "End With"
            ]
        },
        {
            "caption": "pick face",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Pick",
                ".PickFaceFromId \"component1:solid1\", \"5\"",
                "End With"
            ]
        },
        {
            "caption": "pick face",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Pick",
                ".PickFaceFromId \"component1:solid1\", \"8\"",
                "End With"
            ]
        },
        {
            "caption": "shell object: component1:solid1",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Solid",
                ".AdvancedShell \"component1:solid1\", \"Outside\", \"wall_thickness\"",
                "End With"
            ]
        },
        {
            "caption": "pick end point",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Pick",
                ".PickEndpointFromId \"component1:solid1\", \"16\"",
                "End With"
            ]
        },
        {
            "caption": "pick end point",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Pick",
                ".PickEndpointFromId \"component1:solid1\", \"15\"",
                "End With"
            ]
        },
        {
            "caption": "pick end point",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Pick",
                ".PickEndpointFromId \"component1:solid1\", \"13\"",
                "End With"
            ]
        },
        {
            "caption": "define port: 1",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Port ",
                ".Reset ",
                ".PortNumber \"1\"",
                ".NumberOfModes \"1\"",
                ".AdjustPolarization False ",
                ".PolarizationAngle \"0.0\"",
                ".ReferencePlaneDistance \"0\"",
                ".TextSize \"50\"",
                ".Coordinates \"Picks\"",
                ".Orientation \"zmin\"",
                ".PortOnBound \"True\"",
                ".ClipPickedPortToBound \"False\"",
                ".Create ",
                "End With"
            ]
        },
        {
            "caption": "clear picks",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Pick",
                ".ClearAllPicks",
                "End With"
            ]
        },
        {
            "caption": "define units",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Units ",
                ".Geometry \"mm\"",
                ".Frequency \"GHz\"",
                ".Time \"ns\"",
                "End With"
            ]
        },
        {
            "caption": "define frequency range",
            "version": "2017.0|26.0.1|20161205",
            "hidden": false,
            "type": "vba",
            "code": [
                "Solver.FrequencyRange \"4\", \"5\""
            ]
        },
        {
            "caption": "define background",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Background ",
                ".Reset ",
                ".Type \"Normal\"",
                ".Epsilon \"1.0\"",
                ".Mu \"1.0\"",
                ".ThermalType \"Normal\"",
                ".ThermalConductivity \"0.0\"",
                ".XminSpace \"0.0\"",
                ".XmaxSpace \"0.0\"",
                ".YminSpace \"0.0\"",
                ".YmaxSpace \"0.0\"",
                ".ZminSpace \"0.0\"",
                ".ZmaxSpace \"1.5*horn_length\"",
                ".ApplyInAllDirections \"False\"",
                "End With"
            ]
        },
        {
            "caption": "define boundaries",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Boundary",
                ".Xmin \"expanded open\"",
                ".Xmax \"expanded open\"",
                ".Ymin \"expanded open\"",
                ".Ymax \"expanded open\"",
                ".Zmin \"expanded open\"",
                ".Zmax \"expanded open\"",
                ".Xsymmetry \"magnetic\"",
                ".Ysymmetry \"electric\"",
                ".Zsymmetry \"none\"",
                ".Zsymmetry \"none\"",
                "End With"
            ]
        },
        {
            "caption": "define pml specials",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Boundary",
                ".MinimumDistanceReferenceFrequencyType \"CenterNMonitors\"",
                "End With"
            ]
        },
        {
            "caption": "define farfield monitor: farfield (f=5)",
            "version": "2017.0|26.0.1|20161205",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Monitor ",
                "     .Delete \"farfield (f=fctr)\" ",
                "End With ",
                "With Monitor ",
                "     .Reset ",
                "     .Name \"farfield (f=5)\" ",
                "     .Domain \"Frequency\" ",
                "     .FieldType \"Farfield\" ",
                "     .Frequency \"5\" ",
                "     .ExportFarfieldSource \"False\" ",
                "     .UseSubvolume \"False\" ",
                "     .Coordinates \"Free\" ",
                "     .SetSubvolume \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\" ",
                "     .SetSubvolumeOffset \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\" ",
                "     .SetSubvolumeOffsetType \"Absolute\" ",
                "     .Create ",
                "End With"
            ]
        },
        {
            "caption": "define monitor: e-field (f=5)",
            "version": "2017.0|26.0.1|20161205",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Monitor ",
                "     .Delete \"e-field (f=fctr)\" ",
                "End With ",
                "With Monitor ",
                "     .Reset ",
                "     .Name \"e-field (f=5)\" ",
                "     .Dimension \"Volume\" ",
                "     .Domain \"Frequency\" ",
                "     .FieldType \"Efield\" ",
                "     .Frequency \"5\" ",
                "     .UseSubvolume \"False\" ",
                "     .Coordinates \"Free\" ",
                "     .SetSubvolume \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\" ",
                "     .SetSubvolumeOffset \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\" ",
                "     .Create ",
                "End With"
            ]
        },
        {
            "caption": "define monitor: h-field (f=5)",
            "version": "2017.0|26.0.1|20161205",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Monitor ",
                "     .Delete \"h-field (f=fctr)\" ",
                "End With ",
                "With Monitor ",
                "     .Reset ",
                "     .Name \"h-field (f=5)\" ",
                "     .Dimension \"Volume\" ",
                "     .Domain \"Frequency\" ",
                "     .FieldType \"Hfield\" ",
                "     .Frequency \"5\" ",
                "     .UseSubvolume \"False\" ",
                "     .Coordinates \"Free\" ",
                "     .SetSubvolume \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\" ",
                "     .SetSubvolumeOffset \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\", \"0.0\" ",
                "     .Create ",
                "End With"
            ]
        },
        {
            "caption": "define solver parameters",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Solver ",
                ".CalculationType \"TD-S\"",
                ".StimulationPort \"All\"",
                ".StimulationMode \"All\"",
                ".SteadyStateLimit \"-40\"",
                ".AdaptivePortMeshing False",
                "End With"
            ]
        },
        {
            "caption": "(*) s-parameter post processing: vswr",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With PostProcess1D ",
                ".ActivateOperation \"vswr\", \"True\"",
                "End With"
            ]
        },
        {
            "caption": "(*) s-parameter post processing: yz-matrices",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With PostProcess1D ",
                ".ActivateOperation \"yz-matrices\", \"True\"",
                "End With"
            ]
        },
        {
            "caption": "switch bounding box",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "Plot.DrawBox \"True\""
            ]
        },
        {
            "caption": "switch working plane",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "Plot.DrawWorkplane \"false\""
            ]
        },
        {
            "caption": "set mesh properties (Hexahedral)",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "With MeshSettings ",
                "     .SetMeshType \"Hex\" ",
                "     .Set \"StepsPerWaveNear\", \"10\" ",
                "End With"
            ]
        },
        {
            "caption": "change solver type",
            "version": "2017.0|26.0.1|20161127",
            "hidden": false,
            "type": "vba",
            "code": [
                "ChangeSolverType \"HF Time Domain\""
            ]
        },
        {
            "caption": "reset mcalc defaults",
            "version": "2021.0|30.0.1|20200813",
            "hidden": false,
            "type": "vba",
            "code": [
                "Mesh.ResetToMCalcDefaults"
            ]
        },
        {
            "caption": "set PBA version",
            "version": "2021.0|30.0.1|20200813",
            "hidden": false,
            "type": "vba",
            "code": [
                "Mesh.PBAVersion \"2020081321\""
            ]
        },
        {
            "caption": "set mesh properties (Hexahedral)",
            "version": "2021.0|30.0.1|20200813",
            "hidden": false,
            "type": "vba",
            "code": [
                "With Mesh ",
                "     .MeshType \"PBA\" ",
                "     .SetCreator \"High Frequency\"",
                "End With ",
                "With MeshSettings ",
                "     .SetMeshType \"Hex\" ",
                "     .Set \"Version\", 1%",
                "     'MAX CELL - WAVELENGTH REFINEMENT ",
                "     .Set \"StepsPerWaveNear\", \"10\" ",
                "     .Set \"StepsPerWaveFar\", \"10\" ",
                "     .Set \"WavelengthRefinementSameAsNear\", \"1\" ",
                "     'MAX CELL - GEOMETRY REFINEMENT ",
                "     .Set \"StepsPerBoxNear\", \"20\" ",
                "     .Set \"StepsPerBoxFar\", \"1\" ",
                "     .Set \"MaxStepNear\", \"0\" ",
                "     .Set \"MaxStepFar\", \"0\" ",
                "     .Set \"ModelBoxDescrNear\", \"maxedge\" ",
                "     .Set \"ModelBoxDescrFar\", \"maxedge\" ",
                "     .Set \"UseMaxStepAbsolute\", \"0\" ",
                "     .Set \"GeometryRefinementSameAsNear\", \"0\" ",
                "     'MIN CELL ",
                "     .Set \"UseRatioLimitGeometry\", \"1\" ",
                "     .Set \"RatioLimitGeometry\", \"15\" ",
                "     .Set \"MinStepGeometryX\", \"0\" ",
                "     .Set \"MinStepGeometryY\", \"0\" ",
                "     .Set \"MinStepGeometryZ\", \"0\" ",
                "     .Set \"UseSameMinStepGeometryXYZ\", \"1\" ",
                "End With ",
                "With MeshSettings ",
                "     .Set \"PlaneMergeVersion\", \"2\" ",
                "End With ",
                "With MeshSettings ",
                "     .SetMeshType \"Hex\" ",
                "     .Set \"FaceRefinementOn\", \"0\" ",
                "     .Set \"FaceRefinementPolicy\", \"2\" ",
                "     .Set \"FaceRefinementRatio\", \"2\" ",
                "     .Set \"FaceRefinementStep\", \"0\" ",
                "     .Set \"FaceRefinementNSteps\", \"2\" ",
                "     .Set \"EllipseRefinementOn\", \"0\" ",
                "     .Set \"EllipseRefinementPolicy\", \"2\" ",
                "     .Set \"EllipseRefinementRatio\", \"2\" ",
                "     .Set \"EllipseRefinementStep\", \"0\" ",
                "     .Set \"EllipseRefinementNSteps\", \"2\" ",
                "     .Set \"FaceRefinementBufferLines\", \"3\" ",
                "     .Set \"EdgeRefinementOn\", \"1\" ",
                "     .Set \"EdgeRefinementPolicy\", \"1\" ",
                "     .Set \"EdgeRefinementRatio\", \"2\" ",
                "     .Set \"EdgeRefinementStep\", \"0\" ",
                "     .Set \"EdgeRefinementBufferLines\", \"3\" ",
                "     .Set \"RefineEdgeMaterialGlobal\", \"0\" ",
                "     .Set \"RefineAxialEdgeGlobal\", \"0\" ",
                "     .Set \"BufferLinesNear\", \"3\" ",
                "     .Set \"UseDielectrics\", \"1\" ",
                "     .Set \"EquilibrateOn\", \"0\" ",
                "     .Set \"Equilibrate\", \"1.5\" ",
                "     .Set \"IgnoreThinPanelMaterial\", \"0\" ",
                "End With ",
                "With MeshSettings ",
                "     .SetMeshType \"Hex\" ",
                "     .Set \"SnapToAxialEdges\", \"1\"",
                "     .Set \"SnapToPlanes\", \"1\"",
                "     .Set \"SnapToSpheres\", \"1\"",
                "     .Set \"SnapToEllipses\", \"1\"",
                "     .Set \"SnapToCylinders\", \"1\"",
                "     .Set \"SnapToCylinderCenters\", \"1\"",
                "     .Set \"SnapToEllipseCenters\", \"1\"",
                "End With ",
                "With Discretizer ",
                "     .ConnectivityCheck \"True\"",
                "     .UsePecEdgeModel \"True\" ",
                "     .PointAccEnhancement \"0\" ",
                "     .TSTVersion \"0\"",
                "\t  .PBAVersion \"2020081321\" ",
                "End With"
            ]
        }
    ]
}